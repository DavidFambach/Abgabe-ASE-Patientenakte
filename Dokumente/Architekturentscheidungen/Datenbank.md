# Architekturentscheidung: Datenbank

## Zusammenfassung
Bereich: Eingesetzte externe Komponenten
Thema: Datenbank
ID: AD4
Architekturentscheidung: Verwendung von Postgres als Datenbankmanagementsystem (DBMS)

|                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Problemstellung           | Es ist ein Datenbankmanagementsystem auszuwählen, das geignet ist, die durch die Anwendung anfallenden Daten zu verwalten. Dabei ist nur eine Datenbankinstanz zu verwenden, die aber auch nur von einer Instanz des Dateiablagedienstes verwendet wird.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Annahmen                  | - Python wird als Programmiersprache für den Dateiablagedienst eingesetzt<br>- Es wird eine einzige, zentrale Datenbankinstanz eingesetzt.<br>- Nur der Dateiablagedienst muss regulär in der Lage sein, auf die Datenbank zuzugreifen und von diesem Dienst ist nur eine Instanz gleichzeitig aktiv.<br>- Die Datenbankinstanz muss als Docker-Container lauffähig sein.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Motivation                | Sicheres Ablegen von Daten mit validierter Struktur.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Alternativen              | MySQL (relational)<br>PostgreSQL (relational)<br>MongoDB (dokumentenorientiert)<br>Apache CouchDB (dokumentenorientiert)<br>SQLite (relational)<br>Microsoft SQL Server (relational)<br>Oracle Datenbank (relational)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Entscheidung              | Verwende PostgreSQL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Begründung                | Weil es sich bei der Aufgabe um ein Beispielprojekt handelt, sollten Lizenzkosten dringend vermieden werden. Daher werden nur kostenlose Alternativen betrachtet. Weil Aus demselben Grund wird DBaaS nicht weiter betrachtet.<br>Die abzulegenden Datensätze haben sehr ähnliche Strukturen. Das gilt für Benutzerprofilinformationen und Metainformationen zu Dateien. Von Benutzern hochgeladene Dateien sind nicht näher definierte, aber tendenziell große Binärdaten. Für die ersteren beiden Datentypen sind relationale Datenbanken aufrund ihrer Struktur besonders geeigenet, da sie anders als dokumentenorientierte Datenbanken wirksam die korrekte Struktur erzwingen. Objektorientierte und Key-Value-Datenbanken sind insbesondere für beliebige Binärdaten weniger geeignet sind und liefern auch für die anderen Datentypen keine besonderen Vorteile. Daher werden nur relationale und dokumentorientierte Datenbanken weiter betrachet.<br>Alle betrachteten Datenbanksysteme können in einem Docker-Container betrieben werden. Für SQLite würde dies bedeuten, im Container des Dateiablagedienstes abgelegt zu werden. Das ist hinnehmbar, weil nur eine Instanz des Dateiablagedienstes notwendig ist.<br>Gegen SQLite spricht der im Vergleich zu den anderen Datenbanksystemen stark eingeschränkte Funktionsumfang und die fehlende Eignung für Binärdateien.<br>Von den übrigen relationalen Datenbankmanagementsystemen ist für PostgreSQL das meiste Vorwissen vorhanden und PostgreSQL schneidet sowohl laut [1] als auch erwartungsgemäß hinsichtlich Performance am besten ab. |
| Implikationen             | - Die relationale Datenstruktur muss entweder bei Installation angelegt werden oder durch die Anwendung vor der Verwendung erzeugt werden.<br>- Die Unterstützung für große Binärdaten steht für das ablegen beliebiger Dateien zur Verfügung<br>- Es muss ein PostgreSQL-Datenbankadapter für den Dateiablagedienst eingesetzt werden.<br>- Das Ablegen von nicht strukturierten oder unvollständigen Datensätzen ist außerhalb der rohen Binärdaten nicht möglich.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Abgeleitete Anforderungen | F22, F23, F24, NF10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Zugehörige Entscheidungen | Keine                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

## Entscheidungsmatrix
| Kriterien                            | Gewichtung | MySQL                       | Evaluierung | PostgreSQL                            | Evaluierung | MongoDB                     | Evaluierung | Apache CouchDB              | Evaluierung | SQLite                                  | Evaluierung | Microsoft SQL Server | Evaluierung | Oracle Datenbank     | Evaluierung |
| ------------------------------------ | ---------- | --------------------------- | ----------- | ------------------------------------- | ----------- | --------------------------- | ----------- | --------------------------- | ----------- | --------------------------------------- | ----------- | -------------------- | ----------- | -------------------- | ----------- |
| Kosten                               | Ausschluss |                             | +           |                                       | +           |                             | +           |                             | +           |                                         | +           |                      | -           |                      | -           |
| Vorhandene Expertise                 | 5          |                             | +           |                                       | ++          |                             | O           |                             | --          |                                         | +           |                      | O           |                      | O           |
| Performance                          | 2          | vgl [1]                     | O           | vgl [1]                               | ++          | vgl [1]                     | ++          | vgl [1]                     | ++          |                                         | -           |                      | O           |                      | O           |
| Entwicklungsaufwand                  | 5          | Python-Bibliothek vorhanden | +           | Python-Bibliothek vorhanden + bekannt | ++          | Python-Bibliothek vorhanden | +           | Python-Bibliothek vorhanden | +           | Python-Bibliothek + Expertise vorhanden | ++          |                      | O           |                      | O           |
| Struktur entspricht Daten            | 4          |                             | ++          |                                       | ++          |                             | O           |                             | O           |                                         | ++          |                      | O           |                      | O           |
| Unterstützung großer Binärdaten      | 4          |                             | -           |                                       | O           |                             | O           |                             | -           |                                         | --          |                      | O           |                      | O           |
| Unterstützung paralleler Operationen | 3          |                             | ++          |                                       | ++          |                             | ++          |                             | ++          |                                         | O           |                      | O           |                      | O           |
| **Gesamt**                           |            |                             | 27 Pkt.     |                                       | 60 Pkt.     |                             | 20 Pkt.     |                             | 1 Pkt.      |                                         | 21 Pkt.     |                      | n/a         |                      | n/a         |

Legende zur Evaluierung:
 - ++: Die Alternative ist bezüglich dem Kriterium sehr positiv zu bewerten. Diese Bewertung entspricht 3 Punkten.
 - +: Die Alternative ist bezüglich dem Kriterium positiv zu bewerten. Diese Bewertung entspricht 1 Punkt.
 - O: Die Alternative ist bezüglich dem Kriterium neutral zu bewerten, eine Bewertung der Alternative hinsichtlich dieses Kriteriums ist nicht sinnvoll oder nicht praktikabel oder wurde aus einem anderen Grund nicht vorgenommen. Diese Bewertung entspricht 0 Punkten.
 - \-: Die Alternative ist bezüglich dem Kriterium negativ zu bewerten. Diese Bewertung entspricht -1 Punkt.
 - \-\-: Die Alternative ist bezüglich dem Kriterium sehr negativ zu bewerten. Diese Bewertung entspricht -3 Punkten.
Die Gesamtbewertung ist die Summe der gewichteten Evaluierungen über alle Kriterien, die keine Ausschlusskriterien sind. Alternativen, die bezüglich mindestens einem Ausschlusskriterium negativ bewertet wurden, erhalten keine Gesamtbewertung und werden nicht weiter betrachet.

## Referenzen
 1. https://benchant.com/de/ranking/datenbank-ranking
