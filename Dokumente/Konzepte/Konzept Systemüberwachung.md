# Konzept: Systemüberwachung
Um in einer Microservicearchitektur Fehler und Ineffizienzen im laufenden Betrieb erkennen und einer spezifischen Komponente zuordnen zu können, sind feingranulare Protokolldaten aller Komponenten erforderlich. Auch allgemeine Metriken über Systeme können die Diagnose unterstützen. Diese können dann zum einen zur Untersuchung des Erfüllungsgrades der durch nicht funktionale Anforderung definierten KPIs sowie zur Behandlung von Programmfehlern eingesetzt werden.
Eine Microservicearchitektur hat die Besonderheit, dass Benutzeranfragen in der Regel durch eine Vielzahl von Diensten verarbeitet werden, bevor ein Endergebnis präsentiert werden kann. Jeder einzelne Dienst kann aber Fehler oder Verzögerungen bei der Bearbeitung der Anfrage herbeiführen. Fehler und Verzögerungen entstehen dabei üblicherweise zwar durch einen einzelnen Dienst, werden aber in bestimmten Situationen ausgelöst, die letztendlich von der Benutzeranfrage und vorhergehenden Verarbeitungsschritten abhängig sind. Dementsprechend müssen Protokolldaten einzelner Dienste zur Untersuchung nicht nur vorliegen, sondern auch korrelierbar sein, sodass Verarbeitungsschritte über verschiedene Dienste hinweg einzelnen Benutzeranfragen zugeordnet werden können. Zum einen ist dafür eine einheitliche Protokollierung erforderlich, beispielsweise die Verwendung von Zeitstempeln auf Basis derselben Zeitzone von synchronen Uhren. Zum anderen müssen Protokolleinträge einem Kontext zuordenbar sein. Beides wird durch den OpenTelemetry-Standard ermöglicht. Durch den Einsatz eines zentralen Collectors für OpenTelemetry-Informationen aus allen Komponenten wird eine Sammlung aller Protokolldaten realisiert.
Um also die Systemüberwachung in einer Produktivumgebung zu ermöglichen, kann ein solcher Collector, beispielsweise Jaeger, als eigenständiger Dienst aufgesetzt werden, der die Protokolle aller Dienste einsammelt. Die zu überwachenden Dienste müssen dann lediglich entsprechende OpenTelemetry-Informationen bereitstellen. Das OpenTelemetry-Projekt stellt für verschiedene Programmiersprachen, einschließlich Python, Pakete bereit, die eine einfache Implementierung des Standards ermöglichen [1]. Das Kernmodul ermöglicht dabei die manuelle Erzeugung von Protokolleinträgen. Für eingesetzte Bibliotheken, beispielsweise den Django-Webserver, existieren außerdem vorgefertigte Pakete, die für typische Ereignisse, beispielsweise die Bearbeitung einer HTTP-GET-Anfrage, automatisch Protokolleinträge erzeugen [2]. Auch für das Einsammeln allgemeiner Metriken über Systeme existieren bereits Implementierungen [3]. Der Einsatz dieser Technologien vereinfacht und beschleunigt die Implementierung signifikant und erfüllt dabei die eingangs gesetzten Ziele. Dabei können Fehler und Ineffizienzen nicht nur auf den Dienst, für den sie auftreten, zurückgeführt werden, sondern bis auf den konkreten Abarbeitungsschritt innerhalb des Dienstes. Die Informationen können gesammelt an der Benutzeroberfläche des zentralen Collectors eingesehen werden.

[1]: https://opentelemetry.io/docs/instrumentation/python/ (Zuletzt abgerufen: 17.11.2022 15:30 Uhr)
[2]: https://opentelemetry-python.readthedocs.io/en/latest/examples/django/README.html (Zuletzt abgerufen: 17.11.2022 15:30 Uhr)
[3]: https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/hostmetricsreceiver/README.md (Zuletzt abgerufen: 17.11.2022 15:30 Uhr)
