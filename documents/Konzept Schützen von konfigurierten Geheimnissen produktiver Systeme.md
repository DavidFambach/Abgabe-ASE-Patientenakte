# Konzept: Schützen von konfigurierten Geheimnissen produktiver Systeme
Für bestimmte Konfigurationsparameter des Systems besteht eine besonders hohe Vertraulichkeitsanforderung, weil durch ihre Offenlegung eine Manipulation oder Imitation des Systems möglich wäre. Das umfasst insbesondere die privaten Schlüssel zu Serverzertifikaten, die für TLS-Verbindungen eingesetzt werden, sowie gemeinsame Geheimnisse zwischen Systemen, die in diesem Kontext zur Authentifizierung von Teilen des Systems dienen, beispielsweise Passwörter zu Datenbankbenutzern, die von der Anwendung verwendet werden.
Die Hinterlegung solcher geheimen Konfigurationsparameter auf den Systemen ist unabdingbar, weil sie für den Betrieb erforderlich sind. Private Schlüssel zu Serverzertifikaten müssen zum TLS-Verbindungsaufbau vorliegen, um einen Identitätsnachweis durchführen zu können. Datenbankpasswörter müssen beim Verbinden mit der Datenbank vorliegen, wenn eine Passwortauthentifizierung durchgeführt wird.
Werden solche geheimen Konfigurationsparameter auf einem System gespeichert, stellt sich die Frage nach ihrer Absicherung gegen unerlaubte Einsichtnahme. Die Absicherung soll so erfolgen, dass die Vertraulichkeitsgarantien möglichst stark sind, während gleichzeitig die oben beschriebene Verfügbarkeitsbedingung erfüllt ist. Wenn geheime Konfigurationsparameter in einer Datei abgelegt werden, dann muss der Zugriff auf diese Datei möglichst weit eingeschränkt werden. Bei benutzerbasierter Zugriffssteuerung für Dateien bedeutet das, nur dem Benutzer, der die entsprechende Anwundungskomponente ausführt, den Zugriff einzuräumen. Auf diese Weise ist der Zugriff auf diesen Benutzer, sowie Benutzer mit der Berechtigung zum Überspringen von Berechtigungsprüfungen begrenzt. Eine stärkere Begrenzung ist durch das Dateisystem alleine nicht möglich. Ein Verschlüsseln der Konfigurationsdatei bringt keinen Mehrwert, außer maximal einer Security by Obscurity, weil die Anwendung in der Lage sein muss, wenn nötig auf die geheimen Konfigurationsparameter zuzugreifen und folglich auch etwaige zur Verschlüsselung verwendete Schlüssel kennen muss, diese also auch entsprechend zugreifbar hinterlegt sein müssen.
Geht man davon aus, dass die Anwendung selbständig, also ohne manuelle Interaktion, in der Lage ist, wenn nötig auf die geheimen Konfigurationsparameter zuzugreifen, dann folgt, dass jeder, der ein beliebiges Programm mit denselben Berechtigungen ausführen kann, auch auf die geheimen Konfigurationsparameter zugreifen kann, indem er dieselben Schritte ausführt wie die Anwendung selbst. Diese Voraussetzung ist für die meisten Betriebssysteme weitgehend deckungsgleich mit dem Zugriff auf eine wie oben beschrieben abgesicherte Datei. Dementsprechend wird das Ablegen der geheimen Konfigurationsparameter in einer solchen Datei als ausreichend gesichert angesehen. Die Verwendung von separaten Dateien für die geheimen und sonstigen Konfigurationsparameter ist wünschenswert, um Administratoren eine einfache und klare Unterscheidung zu ermöglichen.
Es bringt keinen Vorteil, die obere Annahme aufzuheben, dass die Anwendung selbständig in der Lage sein muss, die geheimen Konfigurationsparameter einzulesen. Wird für den Zugriff auf diese Konfigurationsparameter erst eine manuelle Aktion erforderlich gemacht, erschwert dies zum einen den Betrieb der Anwendung offensichtlich massiv und zum anderen ist kein verbesserter Schutz zu erwarten, weil davon auszugehen ist, dass jeder, der eine wie oben beschrieben abgesicherte Datei einlesen kann, auch in der Lage ist, eine solche manuelle Interaktion abzufangen beziehungsweise die geheimen Konfigurationsparameter aus dem Hauptspeicher auszulesen.
Ein anderer Verbesserungsansatz ist der Einsatz spezieller Hardware, die das Auslesen von Inhalten unterbindet, aber gleichzeitig deren Verwendung erlaubt. Für gemeinsame Geheimnisse bringt dies keinen Vorteil, weil jede Verwendung eines gemeinsamen Geheimnisses dessen Kenntnis erfordert, ein solches also zwingend auslesbar sein muss. Andere Geheimnisse, insbesondere asymmetrische Schlüssel zu kryptographischen Verfahren, profitieren davon allerdings, weil zumindest ein unberechtigtes Kopieren der Schlüssel ausgeschlossen werden kann, wenn auch kein unberechtigtes Verwenden. Da aber entsprechende Hardware für den Einsatz im Projekt nicht verfügbar ist, wird auf ihren Einsatz verzichtet.
Ein Ansatz zur weiteren Regulierung des Zugriffs auf Dateien, die geheime Konfigurationsparameter enthalten, ist die Schaffung einer Berechtigungsstruktur, die es der Anwendung zunächst erlaubt, die geschützte Datei einzulesen, aber dann in einen weniger privilegierten Modus zu wechseln, sodass das nicht mehr möglich ist. So kann eine Anwendung benötigte Dateiinhalte in den Hauptspeicher laden, dann die Berechtigung zum Lesen der Datei fallen lassen und erst dann Funktionen zur Interaktion von außen aktivieren. Dieses Vorgehen bringt nur für vergleichsweise wenige Angriffsszenarien einen zusätzlichen Schutz, erzeugt aber einen im Verhältnis sehr hohen Aufwand, sodass auch diese Technik nicht eingesetzt wird.
Es ist zu berücksichtigen, dass alle oberen Überlegungen lediglich für das Ablegen von geheimen Konfigurationsparametern auf produktiven Systemen gelten, nicht aber für das Erstellen, Transferieren zwischen Systemen oder Vernichten derselben.
Außerdem können Verfahren eingesetzt werden, die zwar nicht den Vertraulichkeitsschutz von geheimen Konfigurationsparametern erhöhen, aber der Nutzen von diesen Informationen für einen Dritten reduziert werden, indem beispielsweise eine Datenbank, die passwortgeschützt ist, so konfiguriert wird, neben dem Passwort auch die Quelladresse des Zugriffs zu prüfen.
